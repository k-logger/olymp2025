Рюкзак с ограниченным количеством каждого предмета.

Если у нас некоторого предмета k штук, мы оставляем только веса, типа w, 2\*w, 4\*w... (1 << (\_\_lg(k) - 1)\*w и k - (1 << (\_\_lg(k)) - 1).

Тогда все веса типа w, 2\*w, 3\*w, ..., k\*w останутся достижимы.

Асимптотика O(n\*W\*log(k))



Рюкзак за S\*sqrt(S)
w1 + w2 + ... + wn = S

Заметим, что у нас не больше чем sqrt(S) различных весов, пожмем веса в пары типа (вес, количество) свели задачу к предыдущей.





